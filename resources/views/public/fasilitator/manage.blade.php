@extends('layout.index')

@section('css')
    <link rel="stylesheet" href="{{ asset('/css/manage.css') }}" />
@endsection


@section('content')
    <div class="manage-body">
        {{-- Header --}}
        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
            <h1>Aktivitas Dibuat</h1>

            @if (auth()->user() && auth()->user()->fasilitator->verificationStatus->name == 'Sudah Diverifikasi')
                <a href="/activities/create">
                    <div class="btn-fill">
                        Buat Aktivitas
                    </div>
                </a>
            @endif
        </div>

        @php
            $shownActivityCount = 0;
        @endphp

        {{-- Filters --}}
        {{-- <div class="row fs">
        </div> --}}

        {{-- Table --}}
        <div class="manage-table">

            @if ($activities && $activities->count() != 0)
                @foreach ($activities as $a)
                    @php
                        $shownActivityCount++;
                        $status = ''; //verification Status
                        $statusClass = '';
                        $activityClass = '';
                        $activityStatus = '';

                        $status = $a->verificationStatus->name;

                        switch ($status) {
                            case 'Sudah Diverifikasi':
                                $statusClass = 'success';
                                break;
                            case 'Sudah Ditolak':
                                $statusClass = 'danger';

                                break;
                            case 'Menunggu Verifikasi':
                                $statusClass = 'redeem';

                                break;

                            default:
                                break;
                        }

                        if ($status == 'Sudah Diverifikasi') {
                            $activityStatus = $a->activityStatus->name;

                            switch ($activityStatus) {
                                case 'Pendaftaran Sedang Dibuka':
                                    $activityClass = '';
                                    break;
                                case 'Pendaftaran Sudah Ditutup':
                                    $activityClass = 'danger';

                                    break;
                                case 'Aktivitas Sedang Berlangsung':
                                    $activityClass = 'redeem';

                                    break;
                                case 'Pendaftaran Sudah Selesai':
                                    $activityClass = 'success';
                                    break;
                                default:
                                    break;
                            }
                        }
                    @endphp
                    <div class="card-row">
                        <div class="left-container">
                            <div class="left">
                                <a href="/activities/{{ $a->slug }}">
                                    <div class="activity-image">
                                        <img src="{{ asset(
                                            $a->bannerImageUrl
                                                ? 'storage/images/' . $a->bannerImageUrl
                                                : '/images/' . Config::get('constants.default_banner_image'),
                                        ) }}"
                                            alt="">
                                    </div>
                                </a>


                                <div class="col fs">
                                    <a href="/activities/{{ $a->slug }}">
                                        <h3>{{ $a->name }}</h3>
                                    </a>
                                    <div class="row fs">
                                        <div class="col fs">
                                            <div class="row sm">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none">
                                                    <path
                                                        d="M3 11.7693C3 8.28843 3 6.54752 4.08184 5.46661C5.16276 4.38477 6.90367 4.38477 10.3846 4.38477H14.0769C17.5578 4.38477 19.2987 4.38477 20.3796 5.46661C21.4614 6.54752 21.4614 8.28843 21.4614 11.7693V13.6155C21.4614 17.0964 21.4614 18.8373 20.3796 19.9182C19.2987 21.0001 17.5578 21.0001 14.0769 21.0001H10.3846C6.90367 21.0001 5.16276 21.0001 4.08184 19.9182C3 18.8373 3 17.0964 3 13.6155V11.7693Z"
                                                        stroke="#838181" stroke-width="1.5" />
                                                    <path d="M7.61574 4.38461V3M16.8464 4.38461V3M3.46191 8.99996H21.0003"
                                                        stroke="#838181" stroke-width="1.5" stroke-linecap="round" />
                                                    <path
                                                        d="M17.7692 16.3849C17.7692 16.6297 17.672 16.8645 17.4989 17.0376C17.3258 17.2107 17.091 17.308 16.8462 17.308C16.6014 17.308 16.3666 17.2107 16.1935 17.0376C16.0203 16.8645 15.9231 16.6297 15.9231 16.3849C15.9231 16.1401 16.0203 15.9053 16.1935 15.7322C16.3666 15.5591 16.6014 15.4618 16.8462 15.4618C17.091 15.4618 17.3258 15.5591 17.4989 15.7322C17.672 15.9053 17.7692 16.1401 17.7692 16.3849ZM17.7692 12.6926C17.7692 12.9374 17.672 13.1722 17.4989 13.3453C17.3258 13.5184 17.091 13.6157 16.8462 13.6157C16.6014 13.6157 16.3666 13.5184 16.1935 13.3453C16.0203 13.1722 15.9231 12.9374 15.9231 12.6926C15.9231 12.4478 16.0203 12.213 16.1935 12.0399C16.3666 11.8668 16.6014 11.7695 16.8462 11.7695C17.091 11.7695 17.3258 11.8668 17.4989 12.0399C17.672 12.213 17.7692 12.4478 17.7692 12.6926ZM13.1539 16.3849C13.1539 16.6297 13.0566 16.8645 12.8835 17.0376C12.7104 17.2107 12.4756 17.308 12.2308 17.308C11.986 17.308 11.7512 17.2107 11.5781 17.0376C11.405 16.8645 11.3077 16.6297 11.3077 16.3849C11.3077 16.1401 11.405 15.9053 11.5781 15.7322C11.7512 15.5591 11.986 15.4618 12.2308 15.4618C12.4756 15.4618 12.7104 15.5591 12.8835 15.7322C13.0566 15.9053 13.1539 16.1401 13.1539 16.3849ZM13.1539 12.6926C13.1539 12.9374 13.0566 13.1722 12.8835 13.3453C12.7104 13.5184 12.4756 13.6157 12.2308 13.6157C11.986 13.6157 11.7512 13.5184 11.5781 13.3453C11.405 13.1722 11.3077 12.9374 11.3077 12.6926C11.3077 12.4478 11.405 12.213 11.5781 12.0399C11.7512 11.8668 11.986 11.7695 12.2308 11.7695C12.4756 11.7695 12.7104 11.8668 12.8835 12.0399C13.0566 12.213 13.1539 12.4478 13.1539 12.6926ZM8.53853 16.3849C8.53853 16.6297 8.44127 16.8645 8.26816 17.0376C8.09505 17.2107 7.86027 17.308 7.61545 17.308C7.37064 17.308 7.13585 17.2107 6.96274 17.0376C6.78963 16.8645 6.69238 16.6297 6.69238 16.3849C6.69238 16.1401 6.78963 15.9053 6.96274 15.7322C7.13585 15.5591 7.37064 15.4618 7.61545 15.4618C7.86027 15.4618 8.09505 15.5591 8.26816 15.7322C8.44127 15.9053 8.53853 16.1401 8.53853 16.3849ZM8.53853 12.6926C8.53853 12.9374 8.44127 13.1722 8.26816 13.3453C8.09505 13.5184 7.86027 13.6157 7.61545 13.6157C7.37064 13.6157 7.13585 13.5184 6.96274 13.3453C6.78963 13.1722 6.69238 12.9374 6.69238 12.6926C6.69238 12.4478 6.78963 12.213 6.96274 12.0399C7.13585 11.8668 7.37064 11.7695 7.61545 11.7695C7.86027 11.7695 8.09505 11.8668 8.26816 12.0399C8.44127 12.213 8.53853 12.4478 8.53853 12.6926Z"
                                                        fill="#838181" />
                                                </svg>
                                                {{ \Carbon\Carbon::parse($a->cleanUpDate)->format('j M Y') }}
                                            </div>
                                            <div class="row sm">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none">
                                                    <path
                                                        d="M12.7714 6.85737C12.7714 6.65277 12.6901 6.45655 12.5454 6.31188C12.4008 6.16721 12.2045 6.08594 11.9999 6.08594C11.7953 6.08594 11.5991 6.16721 11.4545 6.31188C11.3098 6.45655 11.2285 6.65277 11.2285 6.85737V12.0002C11.2285 12.131 11.2617 12.2597 11.325 12.3741C11.3883 12.4885 11.4797 12.585 11.5906 12.6544L14.6763 14.583C14.8498 14.6915 15.0593 14.7267 15.2588 14.6808C15.3575 14.6581 15.4508 14.6161 15.5334 14.5573C15.6159 14.4986 15.6861 14.4241 15.7398 14.3382C15.7936 14.2523 15.8299 14.1566 15.8467 14.0567C15.8635 13.9567 15.8604 13.8545 15.8377 13.7557C15.815 13.6569 15.773 13.5636 15.7142 13.4811C15.6554 13.3985 15.5809 13.3284 15.495 13.2746L12.7714 11.5723V6.85737Z"
                                                        fill="#838181" />
                                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                                        d="M12 3C9.61305 3 7.32387 3.94821 5.63604 5.63604C3.94821 7.32387 3 9.61305 3 12C3 14.3869 3.94821 16.6761 5.63604 18.364C7.32387 20.0518 9.61305 21 12 21C14.3869 21 16.6761 20.0518 18.364 18.364C20.0518 16.6761 21 14.3869 21 12C21 9.61305 20.0518 7.32387 18.364 5.63604C16.6761 3.94821 14.3869 3 12 3ZM4.54286 12C4.54286 11.0207 4.73574 10.051 5.1105 9.14628C5.48525 8.24153 6.03454 7.41946 6.727 6.727C7.41946 6.03454 8.24153 5.48525 9.14628 5.1105C10.051 4.73574 11.0207 4.54286 12 4.54286C12.9793 4.54286 13.949 4.73574 14.8537 5.1105C15.7585 5.48525 16.5805 6.03454 17.273 6.727C17.9655 7.41946 18.5147 8.24153 18.8895 9.14628C19.2643 10.051 19.4571 11.0207 19.4571 12C19.4571 13.9778 18.6715 15.8745 17.273 17.273C15.8745 18.6715 13.9778 19.4571 12 19.4571C10.0222 19.4571 8.12549 18.6715 6.727 17.273C5.32852 15.8745 4.54286 13.9778 4.54286 12Z"
                                                        fill="#838181" />
                                                </svg>
                                                {{ \Carbon\Carbon::parse($a->startTime)->format('H:i') . ' - ' . \Carbon\Carbon::parse($a->endTime)->format('H:i') . ' WIB' }}
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="col fs">
                                            @if ($status == 'Sudah Diverifikasi')
                                                <div class="row sm">
                                                    <div class="circle {{ $activityClass }}">
                                                    </div>
                                                    {{ $activityStatus }}
                                                </div>
                                            @else
                                                <div class="row hide">
                                                    <div class="circle">
                                                    </div>
                                                    <div class="circle redeem">
                                                    </div>
                                                    <div class="circle success">
                                                    </div>

                                                </div>
                                            @endif
                                            <div class="row hide">
                                                <div class="circle">
                                                </div>
                                                <div class="circle redeem">
                                                </div>
                                                <div class="circle success">
                                                </div>

                                            </div>

                                        </div>
                                        <hr>
                                    </div>
                                </div>
                            </div>

                            <div class="col full">
                                <div class="status {{ $statusClass }}">
                                    {{ $status }}
                                </div>
                            </div>

                        </div>

                        <div class="right">
                            @if ($status == 'Menunggu Verifikasi')
                                {{-- if status is unverified can edit and delete  --}}
                                @php
                                    $today = Carbon\Carbon::now();
                                    $cleanUpDate = Carbon\Carbon::parse($a->cleanUpDate)->subDays(2);
                                    $isPassedMaxEditDate = false;

                                    if ($today->gt($cleanUpDate)) {
                                        $isPassedMaxEditDate = true;
                                    }
                                @endphp
                                @if (!$isPassedMaxEditDate)
                                    <a href="/activities/{{ $a->slug }}/edit">
                                        <div class="action-btn">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none">
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M21.4549 5.41632C21.5499 5.56052 21.5922 5.7331 21.5747 5.9049C21.5573 6.07671 21.481 6.23721 21.3589 6.35932L12.1659 15.5513C12.0718 15.6453 11.9545 15.7126 11.8259 15.7463L7.99689 16.7463C7.87032 16.7793 7.73732 16.7787 7.61109 16.7444C7.48485 16.7101 7.36978 16.6434 7.27729 16.5509C7.18479 16.4584 7.1181 16.3434 7.08382 16.2171C7.04955 16.0909 7.04888 15.9579 7.08189 15.8313L8.08189 12.0033C8.11109 11.8884 8.16616 11.7817 8.24289 11.6913L17.4699 2.47032C17.6105 2.32987 17.8011 2.25098 17.9999 2.25098C18.1986 2.25098 18.3893 2.32987 18.5299 2.47032L21.3589 5.29832C21.3948 5.33432 21.4269 5.37386 21.4549 5.41632ZM19.7679 5.82832L17.9999 4.06132L9.48189 12.5793L8.85689 14.9723L11.2499 14.3473L19.7679 5.82832Z"
                                                    fill="#5822CA" />
                                                <path
                                                    d="M19.6406 17.1599C19.9139 14.8238 20.0012 12.4698 19.9016 10.1199C19.8994 10.0645 19.9087 10.0093 19.9288 9.95769C19.9489 9.90608 19.9795 9.85916 20.0186 9.81989L21.0026 8.83589C21.0295 8.80885 21.0636 8.79014 21.1008 8.78203C21.1381 8.77392 21.1769 8.77674 21.2126 8.79015C21.2483 8.80356 21.2794 8.827 21.3021 8.85764C21.3248 8.88828 21.3381 8.92483 21.3406 8.96289C21.5258 11.7541 21.4555 14.5564 21.1306 17.3349C20.8946 19.3569 19.2706 20.9419 17.2576 21.1669C13.7629 21.5539 10.2362 21.5539 6.74157 21.1669C4.72957 20.9419 3.10457 19.3569 2.86857 17.3349C2.45397 13.7903 2.45397 10.2095 2.86857 6.66489C3.10457 4.64289 4.72857 3.05789 6.74157 2.83289C9.39394 2.53877 12.0663 2.46752 14.7306 2.61989C14.7687 2.62262 14.8052 2.63623 14.8359 2.6591C14.8665 2.68196 14.8899 2.71313 14.9034 2.74891C14.9169 2.78468 14.9198 2.82357 14.9119 2.86096C14.9039 2.89835 14.8854 2.93268 14.8586 2.95989L13.8656 3.95189C13.8267 3.99064 13.7803 4.02101 13.7292 4.04113C13.6781 4.06125 13.6234 4.0707 13.5686 4.06889C11.3453 3.99331 9.11952 4.07853 6.90857 4.32389C6.26251 4.39539 5.65942 4.68261 5.19672 5.13914C4.73403 5.59567 4.43874 6.19485 4.35857 6.83989C3.95762 10.2682 3.95762 13.7316 4.35857 17.1599C4.43874 17.8049 4.73403 18.4041 5.19672 18.8606C5.65942 19.3172 6.26251 19.6044 6.90857 19.6759C10.2636 20.0509 13.7356 20.0509 17.0916 19.6759C17.7376 19.6044 18.3407 19.3172 18.8034 18.8606C19.2661 18.4041 19.5604 17.8049 19.6406 17.1599Z"
                                                    fill="#5822CA" />
                                            </svg>
                                            Edit
                                        </div>
                                    </a>


                                    <form method="POST"
                                        action="{{ route('activity.publicDestroy', ['activity' => $a->slug]) }}">
                                        @csrf
                                        @method('DELETE')
                                        <button type="submit" class="action-btn danger"
                                            onclick="return confirm('Apakah Anda yakin untuk menghapus aktivitas ini?');">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none">
                                                <path
                                                    d="M10 2.25C9.80109 2.25 9.61032 2.32902 9.46967 2.46967C9.32902 2.61032 9.25 2.80109 9.25 3V3.75H5C4.80109 3.75 4.61032 3.82902 4.46967 3.96967C4.32902 4.11032 4.25 4.30109 4.25 4.5C4.25 4.69891 4.32902 4.88968 4.46967 5.03033C4.61032 5.17098 4.80109 5.25 5 5.25H19C19.1989 5.25 19.3897 5.17098 19.5303 5.03033C19.671 4.88968 19.75 4.69891 19.75 4.5C19.75 4.30109 19.671 4.11032 19.5303 3.96967C19.3897 3.82902 19.1989 3.75 19 3.75H14.75V3C14.75 2.80109 14.671 2.61032 14.5303 2.46967C14.3897 2.32902 14.1989 2.25 14 2.25H10ZM10 10.65C10.1989 10.65 10.3897 10.729 10.5303 10.8697C10.671 11.0103 10.75 11.2011 10.75 11.4V18.4C10.75 18.5989 10.671 18.7897 10.5303 18.9303C10.3897 19.071 10.1989 19.15 10 19.15C9.80109 19.15 9.61032 19.071 9.46967 18.9303C9.32902 18.7897 9.25 18.5989 9.25 18.4V11.4C9.25 11.2011 9.32902 11.0103 9.46967 10.8697C9.61032 10.729 9.80109 10.65 10 10.65ZM14.75 11.4C14.75 11.2011 14.671 11.0103 14.5303 10.8697C14.3897 10.729 14.1989 10.65 14 10.65C13.8011 10.65 13.6103 10.729 13.4697 10.8697C13.329 11.0103 13.25 11.2011 13.25 11.4V18.4C13.25 18.5989 13.329 18.7897 13.4697 18.9303C13.6103 19.071 13.8011 19.15 14 19.15C14.1989 19.15 14.3897 19.071 14.5303 18.9303C14.671 18.7897 14.75 18.5989 14.75 18.4V11.4Z"
                                                    fill="#E21919" />
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M5.99066 7.917C6.0111 7.73349 6.09851 7.56396 6.23616 7.44089C6.37381 7.31782 6.55202 7.24985 6.73666 7.25H17.2627C17.4473 7.24985 17.6255 7.31782 17.7632 7.44089C17.9008 7.56396 17.9882 7.73349 18.0087 7.917L18.2087 9.719C18.5717 12.984 18.5717 16.279 18.2087 19.545L18.1887 19.722C18.1186 20.352 17.8407 20.9407 17.3989 21.3952C16.957 21.8497 16.3764 22.1441 15.7487 22.232C13.2615 22.5802 10.7379 22.5802 8.25066 22.232C7.62291 22.1441 7.0423 21.8497 6.60047 21.3952C6.15864 20.9407 5.88075 20.352 5.81066 19.722L5.79066 19.545C5.42785 16.2797 5.42785 12.9843 5.79066 9.719L5.99066 7.917ZM7.40766 8.75L7.28166 9.884C6.93107 13.0393 6.93107 16.2237 7.28166 19.379L7.30166 19.556C7.33476 19.8549 7.46646 20.1342 7.67598 20.3499C7.88549 20.5655 8.16088 20.7053 8.45866 20.747C10.8087 21.076 13.1917 21.076 15.5407 20.747C15.8383 20.7053 16.1136 20.5657 16.3231 20.3502C16.5326 20.1348 16.6644 19.8557 16.6977 19.557L16.7177 19.379C17.0677 16.224 17.0677 13.039 16.7177 9.884L16.5917 8.75H7.40766Z"
                                                    fill="#E21919" />
                                            </svg>
                                            Hapus
                                        </button>
                                    </form>
                                @else
                                    {{-- <p>is passed max edit date</p> --}}
                                @endif
                            @endif

                            @if ($status == 'Sudah Diverifikasi')
                                {{-- TODO: FIX ROUTE HERE: --}}
                                <a href="/{{ $a->slug }}/waiting-for-verification/joinedSukarelawanAttendance">
                                    <div class="action-btn redeem">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none">
                                            <path fill-rule="evenodd" clip-rule="evenodd"
                                                d="M13.354 8.74997H4C3.80109 8.74997 3.61032 8.67096 3.46967 8.5303C3.32902 8.38965 3.25 8.19889 3.25 7.99997C3.25 7.80106 3.32902 7.6103 3.46967 7.46964C3.61032 7.32899 3.80109 7.24997 4 7.24997H13.354C13.5174 6.67405 13.8643 6.16716 14.3419 5.80623C14.8195 5.44529 15.4018 5.25 16.0005 5.25C16.5992 5.25 17.1815 5.44529 17.6591 5.80623C18.1367 6.16716 18.4836 6.67405 18.647 7.24997H20C20.1989 7.24997 20.3897 7.32899 20.5303 7.46964C20.671 7.6103 20.75 7.80106 20.75 7.99997C20.75 8.19889 20.671 8.38965 20.5303 8.5303C20.3897 8.67096 20.1989 8.74997 20 8.74997H18.646C18.4826 9.3259 18.1357 9.83279 17.6581 10.1937C17.1805 10.5547 16.5982 10.7499 15.9995 10.7499C15.4008 10.7499 14.8185 10.5547 14.3409 10.1937C13.8633 9.83279 13.5164 9.3259 13.353 8.74997H13.354ZM14.75 7.99997C14.75 7.66845 14.8817 7.35051 15.1161 7.11609C15.3505 6.88167 15.6685 6.74997 16 6.74997C16.3315 6.74997 16.6495 6.88167 16.8839 7.11609C17.1183 7.35051 17.25 7.66845 17.25 7.99997C17.25 8.3315 17.1183 8.64944 16.8839 8.88386C16.6495 9.11828 16.3315 9.24997 16 9.24997C15.6685 9.24997 15.3505 9.11828 15.1161 8.88386C14.8817 8.64944 14.75 8.3315 14.75 7.99997ZM10.646 16.75H20C20.1989 16.75 20.3897 16.671 20.5303 16.5303C20.671 16.3897 20.75 16.1989 20.75 16C20.75 15.8011 20.671 15.6103 20.5303 15.4696C20.3897 15.329 20.1989 15.25 20 15.25H10.646C10.4823 14.6745 10.1354 14.168 9.65787 13.8074C9.18038 13.4468 8.59835 13.2518 8 13.2518C7.40165 13.2518 6.81962 13.4468 6.34213 13.8074C5.86464 14.168 5.51773 14.6745 5.354 15.25H4C3.80109 15.25 3.61032 15.329 3.46967 15.4696C3.32902 15.6103 3.25 15.8011 3.25 16C3.25 16.1989 3.32902 16.3897 3.46967 16.5303C3.61032 16.671 3.80109 16.75 4 16.75H5.354C5.51773 17.3255 5.86464 17.8319 6.34213 18.1925C6.81962 18.5531 7.40165 18.7482 8 18.7482C8.59835 18.7482 9.18038 18.5531 9.65787 18.1925C10.1354 17.8319 10.4823 17.3255 10.646 16.75ZM6.75 16C6.75 15.6685 6.8817 15.3505 7.11612 15.1161C7.35054 14.8817 7.66848 14.75 8 14.75C8.33152 14.75 8.64946 14.8817 8.88388 15.1161C9.1183 15.3505 9.25 15.6685 9.25 16C9.25 16.3315 9.1183 16.6494 8.88388 16.8839C8.64946 17.1183 8.33152 17.25 8 17.25C7.66848 17.25 7.35054 17.1183 7.11612 16.8839C6.8817 16.6494 6.75 16.3315 6.75 16Z"
                                                fill="#5822CA" />
                                        </svg>
                                        Kelola
                                    </div>
                                </a>
                            @endif
                        </div>
                    </div>
                @endforeach
            @endif


            @if ($shownActivityCount == 0)
                <div class="centered">
                    <img src="{{ asset('images/Register/register-illustration.png') }}" alt="">
                    <div class="col">
                        <h1 class="disabled">Belum ada aktivitas yang dibuat</h1>
                        <h4 class="disabled">*Anda harus terverifikasi untuk membuat aktivitas</h4>
                        @if (auth()->user() && auth()->user()->fasilitator->verificationStatus->name == 'Sudah Diverifikasi')
                            <h3>
                                <div class="row-sm">
                                    <a href="/activities/create" class="selected">Buat Aktivitas</a>
                                </div>
                            </h3>
                        @endif
                    </div>
                </div>
            @endif

        </div>
    </div>
@endsection
